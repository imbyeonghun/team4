<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="team4.cafe.app.dao.MyPageDAO">

<!-- 
게시글 댓글수 가져오는 법
SELECT board.*, count(cm_bo_num) FROM community.board 
left join comment on bo_num = cm_bo_num group by bo_num; 
-->

	<resultMap type="kr.kh.app.model.vo.BoardVO" id="boardMap">
		<id property="bo_num" column="bo_num"/>
		<result property="bo_name" column="bo_name"/>
		<result property="bo_co_num" column="bo_co_num"/>
		<collection property="post" ofType="kr.kh.app.model.vo.PostVO"
			column="po_bo_num" select="selectBoard"/>
	</resultMap>

	<select id="selectBoard" resultType="kr.kh.app.model.vo.BoardVO">
		select * from board where bo_num = #{po_bo_num}
	</select>
	
	<select id="selectCountPost" resultType="int">
		select count(*) from post where po_me_id = #{user.me_id}
	</select>

	<select id="selectCountComment" resultType="int">
		select count(*) from comment where co_me_id = #{user.me_id}
	</select>
	
	<update id="updateInfo">
		update member set  
			me_pw = #{user.me_pw},
			me_name = #{user.me_name},
			me_email = #{user.me_email}
		where 
			me_id = #{user.me_id}
	</update>
	
	<select id="selectPostListByuser" resultType="team4.cafe.app.model.vo.PostVO">
		select * from post where po_me_id = #{user.me_id}		
	</select>
</mapper>